---
import BaseLayout from './BaseLayout.astro';
import PostNavigation from '../components/PostNavigation.astro';
import { useTranslations, type Language } from '../utils/i18n';
import type { CollectionEntry } from 'astro:content';

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  tags: string[];
  lang: Language;
  availableLanguages: Language[];
  baseSlug: string;
  prevPost?: CollectionEntry<'posts'> | null;
  nextPost?: CollectionEntry<'posts'> | null;
}

const { title, description, pubDate, updatedDate, tags, lang, availableLanguages, baseSlug, prevPost, nextPost } = Astro.props;
const t = useTranslations(lang);
---

<BaseLayout
  title={title}
  description={description}
  lang={lang}
  availableLanguages={availableLanguages}
  postSlug={baseSlug}
>
  <article class="max-w-3xl mx-auto">
    <header class="mb-8 p-8 pb-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg text-white">
      <h1 class="text-4xl mb-2 text-white">{title}</h1>
      <p class="text-xl text-white/90 mb-4">{description}</p>
      <div class="text-sm text-white/80 mb-4">
        <time datetime={pubDate.toISOString()}>
          {t('post.published')} {pubDate.toLocaleDateString(lang)}
        </time>
        {updatedDate && (
          <time datetime={updatedDate.toISOString()}>
            | {t('post.updated')} {updatedDate.toLocaleDateString(lang)}
          </time>
        )}
      </div>
    </header>

    <div class="flex gap-2 flex-wrap items-center mb-8 text-sm">
      <span class="font-semibold text-gray-500">{t('post.tags')}:</span>
      {tags.map((tag) => (
        <a href={`/tags/${tag.toLowerCase().replace(/\s+/g, '-')}`} class="bg-blue-50 text-blue-800 px-3 py-1 rounded-full no-underline font-medium transition-colors hover:bg-blue-100">
          {tag}
        </a>
      ))}
    </div>

    <div class="prose prose-lg max-w-none">
      <slot />
    </div>

    <PostNavigation
      prevPost={prevPost ?? null}
      nextPost={nextPost ?? null}
      prevLabel={t('post.previous')}
      nextLabel={t('post.next')}
    />
  </article>
</BaseLayout>
